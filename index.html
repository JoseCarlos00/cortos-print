<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="public/CSS/preloader.css">
  <link rel="stylesheet" href="public/CSS/style.css">
  <link rel="stylesheet" href="public/CSS/tablas.css">

  <link rel="shortcut icon" href="public/images/favicon.png" type="image/x-icon">

  <title>Cortos</title>
</head>

<body>
  <div id="preloader">
    <div class="container">
      <label>Cargando...</label>
      <div class="loading"></div>
    </div>
  </div>

  <header>
    <nav class="navbar">
      <ul class="navbar-nav">
        <li class="nav-item active"><a href="#">Cortos</a></li>
        <li class="nav-item"><a href="./trabajosActivos.html?ordenar=SHIP_TO"> Trabajos Activos</a></li>
        <li class="nav-item"><a href="./inventory.html?ordenar=NoOrdenar">Inventory</a></li>
        <li class="nav-item"><a href="./secuence.html?ordenar=NoOrdenar">Secuencia</a></li>
      </ul>
    </nav>
  </header>

  <section class="filters">
    <form>
      <fieldset>
        <legend>Ordenar por</legend>

        <label>
          <input type="radio" name="ordernar" value="BODEGA" checked>
          BODEGA
        </label>

        <label>
          <input type="radio" name="ordernar" value="ERP ORDER">
          ERP ORDER
        </label>

        <label>
          <input type="radio" name="ordernar" value="PEDIDO">
          PEDIDO
        </label>

        <label>
          <input type="radio" name="ordernar" value="POR PISO">
          POR PISO
        </label>

        <label>
          <input type="radio" name="ordernar" value="NoOrdenar">
          No Ordenar
        </label>
      </fieldset>
    </form>

    <button id="toggleButton" class="btn-ver-mas" disabled>
      <span>
        <svg class="toggleIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
          stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
          <path d="M12 19v-7m0 0V5m0 7H5m7 0h7"></path>
        </svg>
        Mostrar Columnas
      </span>
    </button>
    <div id="checkboxContainer"></div>
  </section>


  <div class="container-file-upload">
    <div class="container-file-upload-form"">
      <form class=" file-upload-form">
      <label for="fileInput" class="file-upload-label">
        <div class="file-upload-design">
          <svg viewBox="0 0 640 520" height="1em">
            <path
              d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144z"
              fill="#007ACC" stroke="#007ACC" stroke-width="0"></path>
            <path
              d="M223 263c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"
              fill="#fff"></path>
          </svg>
          </svg>
          <p class="file-upoad-label-text">Arrastrar y soltar</p>
          <p class="file-upoad-label-text">o</p>
          <span class="browse-button">
            <span class="browse-button-text">Browse file</span>
          </span>
        </div>
        <input id="fileInput" type="file" />
      </label>
      </form>
    </div>

    <div class="nombre-de-archivo">
      <div class="circulo"></div>
      <div id="nombreArchivo"></div>
    </div>
  </div>


  <main>
    <div id="loading-container">
      <label>Cargando...</label>
      <div class="loading"></div>
    </div>

    <style>
      thead td {
        background-color: #958e8e;
      }

      th,
      td {
        padding: 4px;
        position: relative;

        overflow: hidden;
        text-overflow: ellipsis;
        min-width: 40px;
      }

      .resizer {
        width: 5px;
        height: 100%;
        position: absolute;
        top: 0;
        right: 0;
        cursor: col-resize;
        user-select: none;
        background-color: red;
      }

      tr td:nth-child(1) {
        width: var(--width-col-1, auto);
        max-width: var(--width-col-1);
        max-width: var(--width-col-1);
        text-wrap: var(--text-wrap-col-1, initial);
      }

      tr td:nth-child(2) {
        width: var(--width-col-2, auto);
        max-width: var(--width-col-2);
        text-wrap: var(--text-wrap-col-2, initial);
      }

      tr td:nth-child(3) {
        width: var(--width-col-3, auto);
        max-width: var(--width-col-3);
        text-wrap: var(--text-wrap-col-3, initial);
      }

      tr td:nth-child(4) {
        width: var(--width-col-4, auto);
        max-width: var(--width-col-4);
        text-wrap: var(--text-wrap-col-4, initial);
      }

      tr td:nth-child(5) {
        width: var(--width-col-5, auto);
        max-width: var(--width-col-5);
        text-wrap: var(--text-wrap-col-5, initial);
      }

      tr td:nth-child(6) {
        width: var(--width-col-6, auto);
        max-width: var(--width-col-6);
        text-wrap: var(--text-wrap-col-6, initial);
      }

      tr td:nth-child(7) {
        width: var(--width-col-7, auto);
        max-width: var(--width-col-7);
        text-wrap: var(--text-wrap-col-7, initial);
      }

      @media print {
        thead td {
          background-color: #fff;
        }

        .resizer {
          display: none;
        }
      }
    </style>

    <!-- Show HTML preview -->
    <!-- Tabla oculta hasta que se complete la carga -->
    <table>
      <thead>
        <tr>
          <td data-col-index="1" data-t="s" data-v="LOCATION" id="sjs-A1">LOCATION<div class="resizer"></div>
          </td>
          <td data-col-index="2" data-t="s" data-v="ITEM" id="sjs-B1">ITEM<div class="resizer"></div>
          </td>
          <td data-col-index="3" data-t="s" data-v="COLOR" id="sjs-C1">COLOR<div class="resizer"></div>
          </td>
          <td data-col-index="4" data-t="s" data-v="COMPANY" id="sjs-D1">COMPANY<div class="resizer"></div>
          </td>
          <td data-col-index="5" data-t="s" data-v="WORK_ZONE" id="sjs-E1">WORK_ZONE<div class="resizer"></div>
          </td>
          <td data-col-index="6" data-t="s" data-v="AV" id="sjs-F1">AV<div class="resizer"></div>
          </td>
          <td data-col-index="7" data-t="s" data-v="OH" id="sjs-G1">OH<div class="resizer"></div>
          </td>
          <td data-col-index="8" data-t="s" data-v="AL" id="sjs-H1">AL<div class="resizer"></div>
          </td>
          <td data-col-index="10" data-t="s" data-v="IT" id="sjs-I1">IT<div class="resizer"></div>
          </td>
          <td data-col-index="11" data-t="s" data-v="SU" id="sjs-J1">SU<div class="resizer"></div>
          </td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td data-t="s" data-v="1-25-05-DD-01" id="sjs-A2">1-25-05-DD-01</td>
          <td data-t="s" data-v="573-4342-8306" id="sjs-B2">573-4342-8306</td>
          <td data-t="s" data-v="Unico Color - PENDANTE  FLOR B/144PZ - 573" id="sjs-C2">Unico Color - PENDANTE FLOR
            B/144PZ - 573</td>
          <td data-t="s" data-v="FM" id="sjs-D2">FM</td>
          <td data-t="s" data-v="W-Mar Bodega 3" id="sjs-E2">W-Mar Bodega 3</td>
          <td data-t="n" data-v="0" id="sjs-F2">0</td>
          <td data-t="n" data-v="39" id="sjs-G2">39</td>
          <td data-t="n" data-v="0" id="sjs-H2">0</td>
          <td data-t="n" data-v="0" id="sjs-I2">0</td>
          <td data-t="n" data-v="39" id="sjs-J2">39</td>
        </tr>
        <tr>
          <td data-t="s" data-v="1-37-04-DD-03" id="sjs-A3">1-37-04-DD-03</td>
          <td data-t="s" data-v="5044-2809-1850" id="sjs-B3">5044-2809-1850</td>
          <td data-t="s" data-v="Zafiro - OCT PREC 14MM  COL EX 2/OR 70P - 5044" id="sjs-C3">Zafiro - OCT PREC 14MM COL
            EX 2/OR 70P - 5044</td>
          <td data-t="s" data-v="FM" id="sjs-D3">FM</td>
          <td data-t="s" data-v="W-Mar Bodega 4" id="sjs-E3">W-Mar Bodega 4</td>
          <td data-t="n" data-v="0" id="sjs-F3">0</td>
          <td data-t="n" data-v="11" id="sjs-G3">11</td>
          <td data-t="n" data-v="0" id="sjs-H3">0</td>
          <td data-t="n" data-v="0" id="sjs-I3">0</td>
          <td data-t="n" data-v="11" id="sjs-J3">11</td>
        </tr>
        <tr>
          <td data-t="s" data-v="1-40-01-BB-01" id="sjs-A4">1-40-01-BB-01</td>
          <td data-t="s" data-v="323-11028-11728" id="sjs-B4">323-11028-11728</td>
          <td data-t="s" data-v="Oro/Negro - CASCO GUERRERO ZIRC 12.3MM B/2 - 323" id="sjs-C4">Oro/Negro - CASCO
            GUERRERO ZIRC 12.3MM B/2 - 323</td>
          <td data-t="s" data-v="FM" id="sjs-D4">FM</td>
          <td data-t="s" data-v="W-Mar Bodega 4" id="sjs-E4">W-Mar Bodega 4</td>
          <td data-t="n" data-v="0" id="sjs-F4">0</td>
          <td data-t="n" data-v="40" id="sjs-G4">40</td>
          <td data-t="n" data-v="0" id="sjs-H4">0</td>
          <td data-t="n" data-v="0" id="sjs-I4">0</td>
          <td data-t="n" data-v="40" id="sjs-J4">40</td>
        </tr>
        <tr>
          <td data-t="s" data-v="1-40-04-AA-05" id="sjs-A5">1-40-04-AA-05</td>
          <td data-t="s" data-v="9393-9860-22731" id="sjs-B5">9393-9860-22731</td>
          <td data-t="s" data-v="B - PIED HEMATITA REDONDA 11MM 12P - 9393" id="sjs-C5">B - PIED HEMATITA REDONDA 11MM
            12P - 9393</td>
          <td data-t="s" data-v="FM" id="sjs-D5">FM</td>
          <td data-t="s" data-v="W-Mar Bodega 4" id="sjs-E5">W-Mar Bodega 4</td>
          <td data-t="n" data-v="0" id="sjs-F5">0</td>
          <td data-t="n" data-v="163" id="sjs-G5">163</td>
          <td data-t="n" data-v="0" id="sjs-H5">0</td>
          <td data-t="n" data-v="0" id="sjs-I5">0</td>
          <td data-t="n" data-v="163" id="sjs-J5">163</td>
        </tr>
        <tr>
          <td data-t="s" data-v="1-53-02-BB-05" id="sjs-A6">1-53-02-BB-05</td>
          <td data-t="s" data-v="11475-9778-21064" id="sjs-B6">11475-9778-21064</td>
          <td data-t="s" data-v="Multi-Color - ESPIRALES FELIZ CUMPLE B/3PZ - 11475" id="sjs-C6">Multi-Color - ESPIRALES
            FELIZ CUMPLE B/3PZ - 11475</td>
          <td data-t="s" data-v="FM" id="sjs-D6">FM</td>
          <td data-t="s" data-v="W-Mar Bodega 6" id="sjs-E6">W-Mar Bodega 6</td>
          <td data-t="n" data-v="0" id="sjs-F6">0</td>
          <td data-t="n" data-v="19" id="sjs-G6">19</td>
          <td data-t="n" data-v="0" id="sjs-H6">0</td>
          <td data-t="n" data-v="0" id="sjs-I6">0</td>
          <td data-t="n" data-v="19" id="sjs-J6">19</td>
        </tr>
        <tr>
          <td data-t="s" data-v="2-40-01-BB-01" id="sjs-A7">2-40-01-BB-01</td>
          <td data-t="s" data-v="6564-8721-17294" id="sjs-B7">6564-8721-17294</td>
          <td data-t="s" data-v="Azul Rey - GAL LENT CUAD 9 HIL 4CMX18M - 6564" id="sjs-C7">Azul Rey - GAL LENT CUAD 9
            HIL 4CMX18M - 6564</td>
          <td data-t="s" data-v="FM" id="sjs-D7">FM</td>
          <td data-t="s" data-v="W-Mar Bodega 14" id="sjs-E7">W-Mar Bodega 14</td>
          <td data-t="n" data-v="0" id="sjs-F7">0</td>
          <td data-t="n" data-v="131" id="sjs-G7">131</td>
          <td data-t="n" data-v="0" id="sjs-H7">0</td>
          <td data-t="n" data-v="0" id="sjs-I7">0</td>
          <td data-t="n" data-v="131" id="sjs-J7">131</td>
        </tr>
      </tbody>
    </table>
  </main>
  <script>
    const resizers = document.querySelectorAll('.resizer');
    const table = document.querySelector('table');

    resizers.forEach(resizer => {
      resizer.addEventListener('mousedown', function (e) {
        const th = e.target.parentNode;

        console.log(th);


        const { colIndex } = th.dataset;
        console.log('Col Index:', colIndex);

        if (colIndex < 0 || !colIndex || colIndex > table.rows[0].cells.length - 1) {
          return
        }


        const startX = e.pageX;
        const startWidth = th.offsetWidth;

        const handleMouseMove = e => {
          const newWidth = startWidth + (e.pageX - startX);
          // text-wrap: nowrap;
          table.style.setProperty(`--width-col-${colIndex}`, `${newWidth}px`);
          table.style.setProperty(`--text-wrap-col-${colIndex}`, 'nowrap');
        };

        const handleMouseUp = () => {
          document.removeEventListener('mousemove', handleMouseMove);
          document.removeEventListener('mouseup', handleMouseUp);
        };

        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
      });
    });
  </script>

  <div class="button-up-container">
    <a href="#" id="goToTopButton" title="Ir arriba">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
        <path d="M12 2L3 11h6v11h6V11h6z" />
      </svg>
    </a>
  </div>

  <footer></footer>

  <script type="module" src="./index.js"></script>
  <script type="module" src="./xlsx.full.min.js"></script>
</body>

</html>
